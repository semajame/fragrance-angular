<div class="py-[10rem] container mx-auto px-4 h-full">
  <h1 class="text-3xl mb-20">Most Popular Fragrances</h1>
  <!-- Skeleton Loader -->
  <div
    class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6 gap-4 sm:gap-6"
    *ngIf="loading()"
  >
    <div
      *ngFor="let skeleton of skeletons"
      class="animate-pulse p-3 border border-gray-100 rounded-sm shadow-xs bg-white"
    >
      <!-- Image Placeholder -->
      <div class="w-full h-48 bg-gray-200 rounded mb-3"></div>

      <!-- Name & Brand Placeholder -->
      <div class="space-y-2">
        <div class="h-4 bg-gray-200 rounded w-3/4"></div>
        <div class="h-3 bg-gray-200 rounded w-1/2"></div>
      </div>

      <hr class="my-2 sm:my-3" />

      <!-- Reviews Placeholder -->
      <div class="flex items-center justify-between mt-2">
        <div class="h-3 w-10 bg-gray-200 rounded"></div>
        <div class="h-3 w-6 bg-gray-200 rounded"></div>
      </div>
    </div>
  </div>

  <!-- Actual Fragrance Grid -->
  <div
    class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6 gap-4 sm:gap-6"
    *ngIf="!loading() && !error()"
  >
    <a *ngFor="let f of fragrances()" [routerLink]="['/fragrance', f.brand?.name, f.name]">
      <img
        [src]="f.image.url"
        [alt]="f.name"
        class="w-full h-48 object-contain rounded-sm mb-3 bg-white border border-gray-100 shadow-xs p-3"
        loading="lazy"
      />

      <!-- Name & Brand -->
      <div class="my-2 flex-grow">
        <h2 class="text-black text-ellipsis text-sm truncate">
          {{ f.name || 'Unnamed Fragrance' }}
        </h2>
        <p class="text-gray-500 text-xs">
          {{ f.brand?.name || 'Unknown' }}
        </p>
      </div>

      <hr class="my-2 sm:my-3" />

      <!-- Reviews -->
      <div class="flex items-center justify-between text-xs sm:text-sm">
        <p class="flex items-center gap-1">
          <lucide-icon
            [img]="Star"
            class="w-3 h-3 sm:w-4 sm:h-4 text-yellow-300 fill-yellow-300"
          ></lucide-icon>
          {{ f.reviewsScoreAvg || 0 }}
        </p>
        <p class="text-gray-500">Votes: {{ f.reviewsCount || 'N/A' }}</p>
      </div>
    </a>
  </div>

  <!-- Error Message -->
  <div *ngIf="error()" class="text-red-500 text-center mt-6">
    {{ error() }}
  </div>

  <nav hlmPagination class="mt-40 flex justify-center">
    <ul hlmPaginationContent>
      <!-- Previous button -->
      <li hlmPaginationItem>
        <button
          hlmPaginationPrevious
          [disabled]="currentPage() === 1"
          (click)="loadPage(currentPage() - 1)"
          class="flex items-center gap-1 p-2 rounded hover:bg-gray-200 disabled:opacity-50 cursor-pointer"
        >
          <lucide-icon [img]="LeftArrow" class="w-5 h-5"></lucide-icon>
        </button>
      </li>
      <!-- Dynamic pages -->
      <li hlmPaginationItem *ngFor="let page of visiblePages()">
        <button
          hlmPaginationLink
          [class.isActive]="page === currentPage()"
          (click)="loadPage(page)"
        >
          {{ page }}
        </button>
      </li>

      <!-- Ellipsis if not on last range -->
      <li hlmPaginationItem *ngIf="visiblePages()[visiblePages().length - 1] < totalPages">
        <hlm-pagination-ellipsis></hlm-pagination-ellipsis>
      </li>

      <!-- Next button -->
      <li hlmPaginationItem>
        <button
          hlmPaginationNext
          [disabled]="currentPage() === totalPages"
          (click)="loadPage(currentPage() + 1)"
          class="flex items-center gap-1 p-2 rounded hover:bg-gray-200 disabled:opacity-50 cursor-pointer"
        >
          <lucide-icon [img]="Arrow" class="w-5 h-5"></lucide-icon>
        </button>
      </li>
    </ul>
  </nav>
</div>
